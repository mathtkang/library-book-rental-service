{% with messages = get_flashed_messages() %}
{% if messages %} 
<script> 
    alert("{{messages[0]}}") 
</script> 
{% endif %} 
{% endwith %}

{% extends "_base.html" %}

{% block title %}엘리스 도서관{% endblock %}


{% block script %}
<!-- <script>
    function rental_book(librarybook_id){
        $.ajax({
        url:'/rentalBook',
        type:'post',
        data:{
            'book_id':librarybook_id
        },
        success: function(res) {
            if(res['result'] == 'success') {
                if (confirm('대여가 완료되었습니다. 대여목록으로 이동하시겠습니까?')){
                    return window.location.href = '/rentalList'
                } else {
                    return window.location.href = '/'
                }
            } else if (res['result'] == 'fail'){
                alert("재고가 없어서 대여할 수 없습니다. 다른 책을 대여해주세요.")
                window.location.href = '/rentalBook'
            } else if (res['result'] == 'already'){
                alert("이미 대여한 책 입니다. 대여목록에서 확인해주세요.")
                window.location.href = '/rentalList'
            // } else if (res['result'] == 'full'){
            //     alert("대여 가능 권수를 초과했습니다. 대여 중인 책을 반납 후 이용해주세요.")
            }
        }
    })
    }
</script> -->
{% endblock %}

{% include "_header.html" %}
{% block content %}


{% if book_list %}
<div method="post" class="container px-4 px-lg-5 mt-5">
    <div class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-center">
        {% for book in book_list %}
        <form method="post" 0class="col mb-5">
            <div class="card h-100" style="border: 1px solid #a589f2">
                <!-- .card {
                    position: relative;
                    display: flex;
                    flex-direction: column;
                    min-width: 0;
                    word-wrap: break-word;
                    background-color: #fff;
                    background-clip: border-box;
                    border: 1px solid rgba(0, 0, 0, 0.125);
                    border-radius: 0.25rem;
                } -->
                <div style="width:262px; height:262px; ">
                    <!-- 450*300 -->
                    <img class="card-img-top" src="../{{ book.img_link }}" alt="{{ book.book_name }}" style="display: block; width:70%; border-bottom: 0; margin: 0 auto; "/>
                </div>
                <div class="card-body p-4">
                    <!-- .card-body {
                        flex: 1 1 auto;
                        padding: 1rem 1rem;
                    }
                    .p-4 {
                        padding: 1.5rem !important;
                    } -->
        
                    <div class="text-center">
                        <h5 id="book_name" class="fw-bolder" style="font-size: 18px;">
                            <!-- .fw-bolder {
                                font-weight: bolder !important;
                            } -->
                            {{ book.book_name }}
                        </h5>
                        <div style="margin-top:15px;">
                            {% for _ in range(book.star) %}
                                <img width="28" src="../static/img/star_fill.png">
                            {% endfor %}
                            {% for _ in range(5 - book.star) %}
                                <img width="28" src="../static/img/star_empty.png">
                            {% endfor %}
                        </div>
                        <div style="padding-top:10px;">
                            {{ book.remaining }}권 남아있습니다.
                        </div>
                    </div>
                </div>
                <!-- Product actions-->
                <div class="card-footer p-4 pt-0 border-top-0 bg-transparent" style="margin:0 auto;">
                <!-- 가운데로 보내주기 -->
                    <input type="hidden" name="book_id" value="{{ book.id }}">
                    <button class="text-center btn btn-outline-dark mt-auto">대여하기</button>
                    <span class="text-center"><a class="btn btn-outline-dark mt-auto" href="/bookDetail/{{ book.id }}">자세히보기</a></span>
                </div>
            </div>
        </form>
        
        {% endfor %}
    </div>
</div>

{% else %}
<div>book_list가 없습니다</div>
{% endif %}



{% endblock %}